{% extends 'base/base.html' %} {% block content %}

<br />
<div class="btn">
  <div class="search">
    <input id="student" type="text" class="searchTerm" placeholder="STUDENT" />
    <button id="student1" type="submit" class="searchButton">
      <i class="fa fa-search"></i>
    </button>
  </div>
  <br />

  <br />
  <br />
  <div id="stud_done"></div>
  <br /><br />
  <table align="center" style="width: 80%; font-family: Montserrat">
    <tr>
      <th>ID</th>
      <th>NAME</th>
      <th>MOBILE NUMBER</th>
      <th>EMAIL</th>
      <th>ENROLLENT DATE</th>
      <th>ACTION</th>
    </tr>
    {% for s1 in p %}
    <tr>
      <td>{{s1.pk}}</td>
      <td>{{s1.first_name}} {{s1.last_name}}</td>
      <td>{{s1.mobile_number}}</td>
      <td>{{s1.email_id}}</td>
      <td>{{s1.enroll_date}}</td>
      <td>
        <a href="{% url 'edit_student' s1.student_id %}">Edit</a> |
        <a href="{% url 'delete_student' s1.student_id %}">Delete</a> |
        <a href="{% url 'view_student' s1.student_id %}">View</a>
      </td>
    </tr>
    {% endfor %}
  </table>
  <br />
  <div class="pagination" style="width: 20%; position: absolute; left: 40%">
    <ul style="position: absolute; left: 10%">
      {% if p.has_previous %}
      <li><a href="?page={{p.previous_page_number}}">Previous</a></li>
      {% endif %} {% for pg in p.paginator.page_range %} {% if p.number == pg %}
      <li class="active" style="background-color: orange; color: white">
        <a href="?page={{pg}}">{{pg}}</a>
      </li>
      {% elif pg > p.number|add:'-2' and pg < p.number|add:'2' %}
      <li><a href="?page={{ pg }}">{{pg}}</a></li>
      {% endif %} {% endfor %} {% if p.has_next %}
      <li><a href="?page={{p.next_page_number}}">Next</a></li>
      {% endif %}
    </ul>
  </div>

  <br />
  <a style="margin-left: 150px" class="button" href="{% url 'add_student' %}"
    >ADD STUDENT</a
  >
  <a
    style="margin-left: 30px"
    href="{% url 'student_export' %}"
    onClick="func()"
    class="button" >EXPORT STUDENTS</a
  >

  <script>
    function func() {
      alert("CSV File will Begin Downloading");
    }
  </script>
  <script src="https://code.jquery.com/jquery-3.4.1.js"></script>

  <script>
    $("#student1").click(function () {
      //var url = $("#form1").attr("data-modules-url");

      var facId = $("#student").val();
      console.log(facId); // get the selected country ID from the HTML input

      $.ajax({
        // initialize an AJAX request
        url: "/ajax/student_search/",
        type: "GET", // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          student_id: facId, // add the country id to the GET parameters
        },
        success: function (data) {
          // `data` is the return of the `load_cities` view function
          $("#stud_done").html(data); // replace the contents of the city input with the data that came from the server
        },
      });
    });
  </script>
</div>
{% endblock content %}